<div class="project-controls__nav">
    <div class="p-grid p-nogutter p-p-3">
        <div class="p-col-6 p-d-flex p-ai-center">
            <i class="pi pi-chevron-left p-pr-2 project-controls__back" [routerLink]="['/project']"></i>
            <img
                src="/assets/stepflow-logo.svg"
                [routerLink]="['/project']"
                alt="Stepflow logo"
                height="26px"
                class="project-controls__back-link"
            />
            <div class="project-controls__divider p-mx-3"></div>
            <div class="ms-1 p-text-bold">{{ projectName }}</div>
        </div>
        <div class="p-col-6 p-d-flex p-jc-end p-ai-center">
            <i class="pi pi-cog ms-3 p-mr-3 project-controls__settings" (click)="showSettingsDialog()"></i>
            <p-button label="Share" icon="pi pi-users" class="p-mr-3" (click)="showShareDialog()"></p-button>
            <app-user-menu [showUsername]="false"></app-user-menu>
        </div>
    </div>
</div>

<p-dialog
    header="Share &quot;{{ projectName }}&quot;"
    [(visible)]="displayShareDialog"
    styleClass="dialog"
    focusTrap="true"
    modal="true"
>
    <div class="p-mt-1 p-inputgroup">
        <input type="text" pInputText placeholder="Email" />
        <button type="button" pButton pRipple label="Share" class="p-button-secondary"></button>
    </div>
    <div class="ms-01 p-mt-3 p-text-uppercase p-text-bold">Shared with</div>
    <p-table [value]="projectUsers" styleClass="p-datatable-sm" [scrollable]="true" scrollHeight="180px">
        <ng-template pTemplate="colgroup">
            <colgroup>
                <col />
                <col />
                <col />
            </colgroup>
        </ng-template>
        <ng-template pTemplate="body" let-projectUser>
            <tr>
                <td style="width: 30%">{{ projectUser.name }}</td>
                <td style="width: 50%">{{ projectUser.email }}</td>
                <td class="p-d-flex p-jc-end" style="margin-bottom: -1px">
                    <p-dropdown
                        [options]="roles"
                        [(ngModel)]="selectedRole"
                        optionLabel="name"
                        appendTo="body"
                    ></p-dropdown>
                </td>
            </tr>
        </ng-template>
    </p-table>
    <div class="ms-01 p-mt-3 p-text-uppercase p-text-bold">Shareable link</div>
    <div class="p-inputgroup p-mt-2">
        <input type="text" pInputText value="{{ href }}" readonly #linkInput />
        <button
            type="button"
            pButton
            pRipple
            label="Copy Link"
            icon="pi pi-link"
            iconPos="left"
            class="p-button-secondary"
            (click)="copyInputMessage(linkInput)"
        ></button>
    </div>
    <div class="p-px-2 p-py-4">
        <i class="pi pi-users"></i>
        <p-dropdown
            [options]="permissions"
            [(ngModel)]="selectedPermission"
            optionLabel="permission"
            class="p-mx-2"
            appendTo="body"
        ></p-dropdown>
        <i>Only people added can open this link</i>
    </div>
    <p-footer>
        <button type="button" pButton label="Done" (click)="hideShareDialog()"></button>
    </p-footer>
</p-dialog>

<p-dialog header="Settings" [(visible)]="displaySettingsDialog" styleClass="dialog" focusTrap="true" modal="true">
    <div class="p-field">
        <label for="settingsDialogTitle">Title</label>
        <input type="text" pInputText value="{{ projectName }}" id="settingsDialogTitle" style="width: 100%" />
    </div>
    <div class="p-field p-pt-2">
        <label for="settingsDialogDescription">Description</label>
        <input
            type="text"
            pInputText
            value="{{ projectDescription }}"
            id="settingsDialogDescription"
            style="width: 100%"
        />
    </div>
    <p-footer>
        <button type="button" pButton label="Save" (click)="hideSettingsDialog()"></button>
    </p-footer>
</p-dialog>
