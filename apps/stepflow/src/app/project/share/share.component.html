<p-button label="Share" icon="pi pi-users" class="p-mr-3" (click)="showShareDialog()"></p-button>
<p-dialog
    header="Share project"
    [(visible)]="displayShareDialog"
    styleClass="share-dialog"
    focusTrap="true"
    modal="true"
>
    <div class="p-mt-1 p-d-flex p-jc-between">
        <div style="flex: 1">
            <p-chips
                [(ngModel)]="invitationEmails"
                [style]="{ height: '36px', minWidth: '100%' }"
                (onAdd)="validateEmails()"
                (onRemove)="validateEmails()"
            ></p-chips>
        </div>
        <div>
            <p-dropdown
                appendTo="body"
                [options]="roles"
                [(ngModel)]="invitationRole"
                [style]="{ width: '150px', textAlign: 'left' }"
                styleClass="p-mx-2"
            ></p-dropdown>
            <button
                type="button"
                pButton
                label="Share"
                icon="pi pi-send"
                class="p-button"
                [loading]="isLoading"
                (click)="onSendInvitationsSelected()"
            ></button>
        </div>
    </div>
    <p-message
        *ngIf="emailValidationMsg != ''"
        severity="error"
        text="{{ emailValidationMsg }}"
        styleClass="p-mt-2"
    ></p-message>

    <div class="ms-01 p-mt-4 p-mb-2 p-text-uppercase p-text-bold">Shared with</div>
    <p-table styleClass="p-datatable-sm" [value]="projectOwners">
        <ng-template pTemplate="body" let-user>
            <tr>
                <td style="width: 30%">{{ user.firstName }} {{ user.lastName }}</td>
                <td style="width: 40%">{{ user.email }}</td>
                <td>
                    <i [style]="{ height: '32px', display: 'block', textAlign: 'center' }">{{ user.role }}</i>
                </td>
            </tr>
        </ng-template>
    </p-table>
    <p-table styleClass="p-datatable-sm" [scrollable]="true" scrollHeight="220px" [value]="projectUsers">
        <ng-template pTemplate="body" let-user>
            <tr>
                <td style="width: 30%">{{ user.firstName }} {{ user.lastName }}</td>
                <td style="width: 40%">{{ user.email }}</td>
                <td style="text-align: center;">
                    <p-dropdown
                        appendTo="body"
                        [options]="roles"
                        [(ngModel)]="user.role"
                        (onChange)="updatePermissions($event, user.id)"
                        [style]="{ width: '150px', textAlign: 'left' }"
                    ></p-dropdown>
                </td>
            </tr>
        </ng-template>
    </p-table>

    <div class="p-d-flex p-jc-end p-ai-center p-mt-4">
        <ng-container *ngIf="displayDialogSave; else dialogDone"
            ><i class="p-mr-2">Pending changes</i>
            <button
                type="button"
                pButton
                pRipple
                label="Save"
                class="p-button"
                (click)="onSavePermissionsSelected()"
            ></button>
        </ng-container>
        <ng-template #dialogDone>
            <button type="button" pButton pRipple label="Done" class="p-button" (click)="hideShareDialog()"></button>
        </ng-template>
    </div>

    <!-- <div class="ms-01 p-mt-3 p-text-uppercase p-text-bold">Shareable link</div>
                <div class="p-inputgroup p-mt-2">
                    <input type="text" pInputText value="{{ href }}" readonly #linkInput />
                    <button
                        type="button"
                        pButton
                        pRipple
                        label="Copy Link"
                        icon="pi pi-link"
                        iconPos="left"
                        class="p-button-secondary"
                        (click)="copyInputMessage(linkInput)"
                    ></button>
                </div>
                <div class="p-px-2 p-py-4">
                    <i class="pi pi-users"></i>
                    <p-dropdown
                        [options]="permissions"
                        [(ngModel)]="selectedPermission"
                        optionLabel="permission"
                        class="p-mx-2"
                        appendTo="body"
                    ></p-dropdown>
                    <i>Only people added can open this link</i>
                </div> -->
    <!-- <p-footer>
                    <button type="button" pButton label="Done" (click)="hideShareDialog()"></button>
                </p-footer> -->
</p-dialog>
